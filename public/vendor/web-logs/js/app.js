(function(){"use strict";var e={200:function(e,t,s){var l=s(963),r=s(252);const o={class:"w-full h-screen"},n=(0,r.Wm)("div",{class:"h-[0rem] border-gray-200"},null,-1),a={class:"flex",style:{height:"calc(100% - 0rem)"}};function i(e,t,s,l,i,c){const u=(0,r.up)("Nav"),d=(0,r.up)("Aside"),m=(0,r.up)("Main"),g=(0,r.up)("log-message-modal"),p=(0,r.up)("log-exception-modal");return(0,r.wg)(),(0,r.j4)("div",o,[n,(0,r.Wm)("div",a,[(0,r.Wm)(u),(0,r.Wm)(d),(0,r.Wm)(m),(0,r.Wm)(g),(0,r.Wm)(p)])])}var c=s(577);const u={class:"w-[20rem] border-r border-gray-200 h-full relative overflow-auto"},d={key:0,class:"absolute inset-0 w-full h-full flex items-center justify-center"},m={class:"p-4 pb-0"},g={class:"divide-y divide-gray-200 px-4 divide-dashed "},p={class:"font-bold"},f={class:"text-sm text-gray-500 font-bold"},h=(0,r.Uk)("Modified ");function b(e,t,s,o,n,a){const i=(0,r.up)("Loading"),b=(0,r.up)("date");return(0,r.wg)(),(0,r.j4)("div",u,[e.store.loading_logs?((0,r.wg)(),(0,r.j4)("div",d,[(0,r.Wm)(i)])):((0,r.wg)(),(0,r.j4)(r.HY,{key:1},[(0,r.Wm)("div",m,[(0,r.wy)((0,r.Wm)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.store.search=t),class:"flex-1 w-full rounded-lg px-3 py-1 border border-gray-200 cursor:ring-2 cursor:ring-blue-500",placeholder:"Search log files.."},null,512),[[l.nr,e.store.search]])]),(0,r.Wm)("div",g,[((0,r.wg)(!0),(0,r.j4)(r.HY,null,(0,r.Ko)(e.store.sorted_logs,(t=>((0,r.wg)(),(0,r.j4)("button",{class:["py-4 text-left w-full cursor:text-blue-600",{"text-blue-600":e.store.current?.name===t.name}],onClick:(0,l.iM)((s=>e.store.fetchLog(t)),["prevent"])},[(0,r.Wm)("div",p,(0,c.zw)(t.name),1),(0,r.Wm)("div",f,[h,(0,r.Wm)(b,{timestamp:t.modified_at},null,8,["timestamp"])])],10,["onClick"])))),256))])],64))])}const x={class:"bx bx-loader-alt bx-spin text-4xl"};function v(e,t,s,l,o,n){return(0,r.wg)(),(0,r.j4)("i",x)}var w=(0,r.aZ)({});w.render=v;var y=w;function _(e,t,s,l,o,n){return(0,r.wg)(),(0,r.j4)("div",{class:"inline",title:e.unixToString(e.unixTimestamp)},(0,c.zw)(e.unixToDiff(e.unixTimestamp)),9,["title"])}var W=(0,r.aZ)({props:{timestamp:{},parse:{default:!1}},computed:{unixTimestamp(){return this.parse?Date.parse(this.timestamp)/1e3:this.timestamp}},created(){this.store.dateComponents.add(this)},unmounted(){this.store.dateComponents.delete(this)}});W.render=_;var k=W,M={name:"Aside",components:{Date:k,Loading:y}};M.render=b;var j=M;const C={style:{width:"calc(100% - 20rem - 4rem)"},class:"h-full"},T={class:"overflow-auto relative",style:{height:"calc(100%)"}},A={key:0,class:"flex items-center justify-center w-full h-full"},L=(0,r.Wm)("div",{class:"text-gray-300 text-4xl font-light"},"Select a log..",-1),z={key:1,class:"absolute inset-0 w-full h-full flex items-center justify-center"},O={class:"p-5 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white"},$={class:"text-lg font-bold"},D={class:"flex space-x-5 text-sm font-bold text-gray-500 py-1"},E=(0,r.Uk)("Created "),H=(0,r.Uk)("Modified "),S={class:"flex space-x-2 items-center"},Z=(0,r.Wm)("i",{class:"bx bx-refresh text-2xl"},null,-1),I={class:"p-5 divide-y divide-dashed divide-gray-200"},Y={class:"py-4"},U={class:"font-bold text-sm inline-flex space-x-2 mb"},F={key:0,class:"mt-4"},P={class:"font-mono"},N={class:"flex"},R={class:"p-2 align-top text-gray-500 min-w-[2rem]"};function B(e,t,s,o,n,a){const i=(0,r.up)("Loading"),u=(0,r.up)("date"),d=(0,r.up)("text-filter");return(0,r.wg)(),(0,r.j4)("div",C,[(0,r.Wm)("div",T,[null===e.store.current?((0,r.wg)(),(0,r.j4)("div",A,[L])):e.store.loading_log?((0,r.wg)(),(0,r.j4)("div",z,[(0,r.Wm)(i)])):((0,r.wg)(),(0,r.j4)(r.HY,{key:2},[(0,r.Wm)("div",O,[(0,r.Wm)("div",null,[(0,r.Wm)("div",$,(0,c.zw)(e.store.current.name),1),(0,r.Wm)("div",D,[(0,r.Wm)("div",null,[E,(0,r.Wm)(u,{timestamp:e.store.current.created_at},null,8,["timestamp"])]),(0,r.Wm)("div",null,[H,(0,r.Wm)(u,{timestamp:e.store.current.modified_at},null,8,["timestamp"])]),(0,r.Wm)("div",null,"Size: "+(0,c.zw)(e.filesize(e.store.current.size)),1)])]),(0,r.Wm)("div",S,[(0,r.Wm)(d,{label:"Links",enabled:e.store.text_links,onClick:t[1]||(t[1]=t=>e.store.toggle("text_links"))},null,8,["enabled"]),(0,r.Wm)("button",{onClick:t[2]||(t[2]=(0,l.iM)((t=>e.store.fetchLog(e.store.current)),["prevent"])),title:"refresh",class:"w-8 h-8 border border-gray-300 shadow rounded-lg ml-2 text-gray-700 cursor:bg-blue-50 cursor:border-blue-600 cursor:text-blue-600 flex items-center justify-center"},[Z])])]),(0,r.Wm)("div",I,[((0,r.wg)(!0),(0,r.j4)(r.HY,null,(0,r.Ko)(e.store.sorted_content,((t,s)=>((0,r.wg)(),(0,r.j4)("div",Y,[(0,r.Wm)("div",U,[(0,r.Wm)("div",{class:["px-2 py-1  border rounded-lg",e.levelClass(t.level)]},(0,c.zw)(t.level),3),(0,r.Wm)(u,{class:"px-2 py-1 text-gray-700",timestamp:t.time,parse:!0},null,8,["timestamp"])]),(0,r.Wm)("div",{class:"whitespace-pre-wrap font-mono with-links leading-6 py-4",innerHTML:e.store.applyFilters(t.content)},null,8,["innerHTML"]),""!==t.trace?((0,r.wg)(),(0,r.j4)(r.HY,{key:0},[(0,r.Wm)("button",{onClick:t=>e.store.toggleTrace(s),class:"rounded-lg px-2 py-1 font-bold text-sm text-blue-500 cursor:text-blue-600 underline"},"Toggle Trace",8,["onClick"]),e.store.traceIsOpen(s)?((0,r.wg)(),(0,r.j4)("div",F,[(0,r.Wm)("div",P,[((0,r.wg)(!0),(0,r.j4)(r.HY,null,(0,r.Ko)(e.store.traceToArray(t.trace),((t,s)=>((0,r.wg)(),(0,r.j4)("div",N,[(0,r.Wm)("div",R,(0,c.zw)(s),1),(0,r.Wm)("div",{title:t,class:"p-2",innerHTML:e.store.applyFilters(t)},null,8,["title","innerHTML"])])))),256))])])):(0,r.ry)("",!0)],64)):(0,r.ry)("",!0)])))),256))])],64))])])}var G=s(246),V=s.n(G);function K(e,t,s,l,o,n){return(0,r.wg)(),(0,r.j4)("button",{onClick:t[1]||(t[1]=t=>e.$emit("click")),class:["rounded-lg border cursor:border-blue-600 cursor:text-blue-600 cursor:bg-blue-50 px-2 py-1 border shadow",e.enabled?"border-green-600 text-green-700":"border-gray-300 text-gray-700"]},(0,c.zw)(e.label)+" "+(0,c.zw)(e.enabled?"enabled":"disabled"),3)}var J=(0,r.aZ)({props:{label:{},enabled:{}},emits:["click"]});J.render=K;var q=J,Q=(0,r.aZ)({components:{Date:k,TextFilter:q,Loading:y},methods:{levelClass(e){let t=e.includes("EMERGENCY")|e.includes("ALERT")|e.includes("CRITICAL")|e.includes("ERROR"),s=e.includes("WARNING")|e.includes("NOTICE")|e.includes("INFO")|e.includes("DEBUG");return{"bg-red-100 text-red-600 border-red-600":t,"bg-yellow-100 text-yellow-600 border-yellow-600":s}}}});Q.render=B;var X=Q,ee=s.p+"img/logo.png";const te={class:"w-[4rem] border-r border-gray-200 h-full flex flex-col items-center py-6 space-y-6"},se=(0,r.Wm)("img",{src:ee,alt:"",class:"w-[2rem]"},null,-1),le=(0,r.Wm)("div",{class:"h-[0] border-b-2 border-gray-200 w-[2rem]"},null,-1),re=(0,r.Wm)("i",{class:"bx bx-refresh text-3xl"},null,-1),oe=(0,r.Wm)("i",{class:"bx bx-send text-3xl"},null,-1),ne=(0,r.Wm)("i",{class:"bx bx-bug-alt text-3xl"},null,-1),ae=(0,r.Wm)("div",{class:"flex-grow"},null,-1),ie=(0,r.Wm)("i",{class:"bx bxl-github text-3xl"},null,-1);function ce(e,t,s,l,o,n){return(0,r.wg)(),(0,r.j4)("div",te,[se,le,(0,r.Wm)("button",{onClick:t[1]||(t[1]=(...t)=>e.store.reloadAll&&e.store.reloadAll(...t)),class:"text-gray-700  cursor:text-blue-600",title:"Reload"},[re]),(0,r.Wm)("button",{onClick:t[2]||(t[2]=t=>e.store.toggle("message_modal")),class:"text-gray-700  cursor:text-blue-600",title:"Trigger A Message"},[oe]),(0,r.Wm)("button",{onClick:t[3]||(t[3]=t=>e.store.toggle("exception_modal")),class:"text-gray-700  cursor:text-blue-600",title:"Trigger An Exception"},[ne]),ae,(0,r.Wm)("a",{href:e.config.github_url,class:"text-gray-700 cursor:text-blue-600",title:"Github"},[ie],8,["href"])])}var ue=(0,r.aZ)({});ue.render=ce;var de=ue;const me=(0,r.Wm)("div",{class:"text-3xl"},"Log A Message",-1),ge={class:"grid grid-cols-3 gap-2"},pe={class:"pl-2 capitalize"},fe=(0,r.Wm)("button",{class:"form-submit"},"Send",-1);function he(e,t,s,o,n,a){const i=(0,r.up)("modal");return e.store.message_modal?((0,r.wg)(),(0,r.j4)(i,{key:0,onClose:t[4]||(t[4]=t=>e.store.toggle("message_modal"))},{default:(0,r.w5)((()=>[(0,r.Wm)("form",{onSubmit:t[3]||(t[3]=(0,l.iM)(((...t)=>e.store.submit_message&&e.store.submit_message(...t)),["prevent"])),class:"space-y-6"},[me,(0,r.Wm)("div",ge,[((0,r.wg)(!0),(0,r.j4)(r.HY,null,(0,r.Ko)(e.levels,(t=>((0,r.wg)(),(0,r.j4)("label",null,[(0,r.wy)((0,r.Wm)("input",{value:t,"onUpdate:modelValue":t=>e.store.message_form.level=t,type:"radio",name:"level"},null,8,["value","onUpdate:modelValue"]),[[l.G2,e.store.message_form.level]]),(0,r.Wm)("span",pe,(0,c.zw)(t),1)])))),256))]),(0,r.wy)((0,r.Wm)("textarea",{ref:"focus","onUpdate:modelValue":t[1]||(t[1]=t=>e.store.message_form.message=t),cols:"30",rows:"6",placeholder:"Message..",class:"form-textarea"},null,512),[[l.nr,e.store.message_form.message]]),fe,(0,r.Wm)("button",{class:"form-cancel",type:"button",onClick:t[2]||(t[2]=(0,l.iM)((t=>e.store.toggle("message_modal")),["prevent"]))},"Cancel")],32)])),_:1})):(0,r.ry)("",!0)}function be(e,t,s,o,n,a){return(0,r.wg)(),(0,r.j4)("div",{onClick:t[2]||(t[2]=t=>e.$emit("close")),class:"fixed inset-0 w-full h-full bg-black bg-opacity-75 z-20 overflow-auto"},[(0,r.Wm)("div",{onClick:t[1]||(t[1]=(0,l.iM)((()=>{}),["stop"])),class:"mx-auto w-full max-w-lg bg-white my-24 rounded-lg p-6 space-y-10"},[(0,r.WI)(e.$slots,"default")])])}var xe=(0,r.aZ)({name:"Modal",created(){document.body.style.overflow="hidden"},unmounted(){document.body.style.overflow="auto"},emits:["close"]});xe.render=be;var ve=xe,we=(0,r.aZ)({components:{Modal:ve},created(){(0,r.YP)((()=>this.store.message_modal),(e=>{e&&this.$nextTick((()=>{this.$refs.focus.focus()}))}))},data:e=>({levels:["emergency","alert","critical","error","warning","notice","info","debug"]})});we.render=he;var ye=we;const _e=(0,r.Wm)("div",{class:"text-3xl"},"Log An Exception",-1),We=(0,r.Wm)("button",{class:"form-submit"},"Send",-1);function ke(e,t,s,o,n,a){const i=(0,r.up)("modal");return e.store.exception_modal?((0,r.wg)(),(0,r.j4)(i,{key:0,onClose:t[4]||(t[4]=t=>e.store.toggle("exception_modal"))},{default:(0,r.w5)((()=>[(0,r.Wm)("form",{onSubmit:t[3]||(t[3]=(0,l.iM)(((...t)=>e.store.submit_exception&&e.store.submit_exception(...t)),["prevent"])),class:"space-y-6"},[_e,(0,r.wy)((0,r.Wm)("textarea",{ref:"focus","onUpdate:modelValue":t[1]||(t[1]=t=>e.store.exception_form.message=t),cols:"30",rows:"6",placeholder:"Exception Message..",class:"form-textarea"},null,512),[[l.nr,e.store.exception_form.message]]),We,(0,r.Wm)("button",{class:"form-cancel",type:"button",onClick:t[2]||(t[2]=(0,l.iM)((t=>e.store.toggle("exception_modal")),["prevent"]))},"Cancel")],32)])),_:1})):(0,r.ry)("",!0)}var Me=(0,r.aZ)({components:{Modal:ve},created(){(0,r.YP)((()=>this.store.exception_modal),(e=>{e&&this.$nextTick((()=>{this.$refs.focus.focus()}))}))}});Me.render=ke;var je=Me,Ce={name:"App",components:{LogExceptionModal:je,LogMessageModal:ye,Nav:de,Main:X,Aside:j}};Ce.render=i;var Te=Ce,Ae=s(669),Le=s.n(Ae),ze=s(262),Oe={base_url:"http://localhost:9001/",github_url:"https://github.com/mojtabaahn/laravel-web-logs"},$e=(0,ze.qj)({logs:[],loading_logs:!1,current:null,current_content:null,loading_log:!1,text_links:!0,auto_reload:!1,search:"",open_traces:[],dateComponents:new Set,exception_form:{message:""},message_form:{message:"",level:"debug"},exception_modal:!1,message_modal:!1,toggle(e){this[e]=!this[e]},async setup(){await this.fetchLogs(),await this.fetchLog(this.sorted_logs[0]),this.setupDateInterval()},teardown(){},async fetchLogs(){this.loading_logs=!0,await axios.get(this.url("/index")).then((e=>{this.loading_logs=!1,this.logs=e.data}))},async fetchLog(e){this.current=e,this.loading_log=!0,await axios.get(this.url(`/${e.name}`)).then((e=>{this.loading_log=!1,this.current_content=e.data}))},applyFilters(e){return this.text_links&&(e=V()(e)),e=e.replaceAll(/([a-zA-Z0-9\\\/\-_\.]+\/)([a-zA-Z0-9\\\-_]+\.(php))/g,"<span class='is-file' title='$1$2'>$2</span>"),e=e.replaceAll(/\\?([a-zA-Z0-9_]+\\{2})+([a-zA-Z0-9_]+)/g,"<span title='$1$2' class='is-class'>$2</span>"),e=e.replaceAll(/([0-9]+)/g,"<span class='is-number'>$1</span>"),e},get sorted_logs(){return this.logs.sort(((e,t)=>t.modified_at-e.modified_at)).filter((e=>e.name.includes(this.search)))},toggleTrace(e){let t=this.current.name+":"+e,s=this.open_traces.indexOf(t);-1===s?this.open_traces.push(t):this.open_traces.splice(t,1)},traceIsOpen(e){return this.open_traces.includes(this.current.name+":"+e)},get sorted_content(){return this.current_content.slice().reverse()},traceToArray(e){let t=null,s=!0,l=e.split(/\#([0-9]+)/gms).reduce(((e,l)=>(s?s=!1:null===t?t=l:(e[t]=l,t=null),e)),[]);return l},submit_exception(){axios.post(this.url("/log-exception"),this.exception_form).then((e=>{console.log(e.data),this.exception_modal=!1,this.exception_form.message=""}))},submit_message(){axios.post(this.url("/log-message"),this.message_form).then((e=>{console.log(e.data),this.message_modal=!1,this.message_form.message="",this.message_form.level="debug"}))},async reloadAll(){if(await this.fetchLogs(),null!==this.current){let e=this.current.name;await this.fetchLog(this.logs.filter((t=>t.name===e))[0])}},url(e){return e="/web-logs"+e,e},setupDateInterval(){setInterval((()=>{for(const e of this.dateComponents)e.$forceUpdate()}),5e3)}});window.axios=Le(),$e.setup();let De=(0,l.ri)(Te);De.config.globalProperties.store=$e,De.config.globalProperties.config=Oe,De.config.globalProperties.filesize=e=>{let t=0===e?0:Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]},De.config.globalProperties.unixToDiff=e=>{let t=6e4,s=60*t,l=24*s,r=30*l,o=365*l,n=(new Date).getTime()-1e3*e;return 0===n?"now":n<t?Math.round(n/1e3)+" seconds ago":n<s?Math.round(n/t)+" minutes ago":n<l?Math.round(n/s)+" hours ago":n<r?Math.round(n/l)+" days ago":n<o?Math.round(n/r)+" months ago":Math.round(n/o)+" years ago"},De.config.globalProperties.unixToString=e=>{let t=new Date(1e3*e),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l=t.getFullYear(),r=s[t.getMonth()],o=t.getDate(),n=t.getHours(),a=t.getMinutes(),i=t.getSeconds();return o+" "+r+" "+l+" "+n+":"+a+":"+i},De.mount("#app")}},t={};function s(l){var r=t[l];if(void 0!==r)return r.exports;var o=t[l]={exports:{}};return e[l](o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,l,r,o){if(!l){var n=1/0;for(c=0;c<e.length;c++){l=e[c][0],r=e[c][1],o=e[c][2];for(var a=!0,i=0;i<l.length;i++)(!1&o||n>=o)&&Object.keys(s.O).every((function(e){return s.O[e](l[i])}))?l.splice(i--,1):(a=!1,o<n&&(n=o));a&&(e.splice(c--,1),t=r())}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[l,r,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var l in t)s.o(t,l)&&!s.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.p="/vendor/web-logs/"}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,l){var r,o,n=l[0],a=l[1],i=l[2],c=0;for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(i)var u=i(s);for(t&&t(l);c<n.length;c++)o=n[c],s.o(e,o)&&e[o]&&e[o][0](),e[n[c]]=0;return s.O(u)},l=self["webpackChunkapp"]=self["webpackChunkapp"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=s.O(void 0,[998],(function(){return s(200)}));l=s.O(l)})();
//# sourceMappingURL=app.js.map